<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body},'index')}">
<link rel="stylesheet" type="text/css" href="/stylesheets/home.css" />
<head>
    <meta charset="UTF-8">
    <title>Checkout</title>
</head>
<body>
<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script th:src="@{/webjars/jquery-ui/jquery-ui.min.js}"></script>
<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>

<div style="background: cornflowerblue; font-family: 'Arial Rounded MT Bold'; font-size: xx-large; text-align: center;">
    <h1><u>Dal-Cart</u></h1>
</div>
    <div class = container admin-container>
        <form action="" >
            <div class="row">
                <div class="container ">
                    <div class="row">
                        <div class="col-lg-12 center text-center admin-title">
                            My Cart
                        </div>
                    </div>

                    <p><span th:text="${message}"></span></p>

                    <div class="row product-list-header">
                        <div class="col-lg-2 text-center product-list-header-item">
                            Product Name
                        </div>
                        <div class="col-lg-2 text-center product-list-header-item">
                            Product Price
                        </div>
                        <div class="col-lg-2 text-center product-list-header-item">
                            Product Quantity
                        </div>
                        <div class="col-lg-2 text-center product-list-header-item">
                            Increase Quantity
                        </div>
                        <div class="col-lg-2 text-center product-list-header-item">
                            Decrease Quantity
                        </div>
                        <div class="col-lg-2 text-center product-list-header-item">
                            Remove from cart
                        </div>
                    </div>
                    <div class="row product-list-row text-center product-row" th:each="product: ${products}">
                        <div class="col-lg-2 flex" th:text="${product.productName}"></div>
                        <div class="col-lg-2 flex" th:text="${product.productPrice}" ></div>
                        <div class="col-lg-2 flex" th:text="${quantity.get(product.productId)}" ></div>
                        <div class="col-lg-2 flex"><button th:value="${quantity.get(product.productId)}" th:id = "${product.productId}" type = "submit" onclick="increase(this.id,this.value)">+</button></div>
                        <div class="col-lg-2 flex"><button>-</button></div>
                        <div class="col-lg-2 flex"><button th:id = "${product.productId}" type = "submit" onclick="removeFromCart(this.id)">Remove</button></div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 text-center admin-button-column">
                    <input type="submit" class="btn btn-dark admin-button"/>
                </div>
            </div>
        </form>
    </div>

<script type="text/javascript">

    function increase(event,data)
    {
        $.ajax({
            type: "POST",
            url: "/increaseQuantityOfProduct",
            data: {
                id: event, // < note use of 'this' here
                quantity: data
            },
            success: function(result) {
                alert('Product increased');
            },
            error: function(result) {
                console.log("id = " + event + "quantity = " + data);
                alert('error');
            }
        });
    }

    function removeFromCart(event)
    {
        $.ajax({
            type: "POST",
            url: "/removeFromCart",
            data: {
                id: event
            },
            success: function(result) {
                alert('Product Added to Cart');
            },
            error: function(result) {
                alert('error');
            }
        });
    }

</script>

</body>
</html>